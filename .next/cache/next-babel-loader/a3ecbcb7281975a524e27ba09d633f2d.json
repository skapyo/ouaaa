{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\skaPy\\\\IdeaProjects\\\\Next.js-boilerplate\\\\oozie-client\\\\containers\\\\forms\\\\ResetPassword\\\\ResetPasswordForm.tsx\";\nvar __jsx = React.createElement;\nimport React from \"react\";\nimport gql from \"graphql-tag\";\nimport FormController, { ValidationRuleType } from \"components/controllers/FormController\";\nimport { withApollo } from \"hoc/withApollo\";\nimport { useState, useCallback } from \"react\";\nimport ResetPasswordEmailForm from \"containers/forms/ResetPassword/subForms/SendResetPsswdEmailForm\";\nimport ValidateEmailCodeForm from \"./subForms/ValidateEmailCodeForm\";\nimport { Container, Box, Avatar, Typography } from \"@material-ui/core\";\nimport VpnKeyOutlinedIcon from \"@material-ui/icons/VpnKeyOutlined\";\nimport { makeStyles } from \"@material-ui/core\";\nconst useStyles = makeStyles(theme => ({\n  avatar: {\n    margin: theme.spacing(1),\n    backgroundColor: theme.palette.secondary.main\n  },\n  title: {\n    marginBottom: theme.spacing(3)\n  }\n}));\n\nconst ResetPasswordFormLayout = ({\n  children\n}) => {\n  const styles = useStyles();\n  return __jsx(Container, {\n    component: \"main\",\n    maxWidth: \"xs\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 30,\n      columnNumber: 5\n    }\n  }, __jsx(Box, {\n    marginTop: 8,\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 31,\n      columnNumber: 7\n    }\n  }, __jsx(Avatar, {\n    className: styles.avatar,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 37,\n      columnNumber: 9\n    }\n  }, __jsx(VpnKeyOutlinedIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 38,\n      columnNumber: 11\n    }\n  })), __jsx(Typography, {\n    component: \"h1\",\n    variant: \"h5\",\n    className: styles.title,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 9\n    }\n  }, \"Mot de passe perdu\"), children));\n};\n/* Reset password email form : step 0*/\n\n\nconst SEND_PASSWORD_RESET_EMAIL = gql`\n  mutation sendResetPasswordEmail($formValues: ResetPasswordInfos) {\n    sendResetPasswordEmail(resetPasswordInfos: $formValues)\n  }\n`;\nconst validationRules0 = {\n  email: {\n    rule: ValidationRuleType.email\n  }\n};\n/* -- */\n\n/* reset code validation form : step 1*/\n// const SEND_PASSWORD_RESET_EMAIL = gql`\n//   mutation sendResetPasswordEmail($formValues: ResetPasswordInfos) {\n//     sendResetPasswordEmail(resetPasswordInfos: $formValues)\n//   }\n// `\n\nconst validationRules1 = {\n  input1: {\n    rule: ValidationRuleType.only,\n    type: \"number\"\n  },\n  input2: {\n    rule: ValidationRuleType.only,\n    type: \"number\"\n  },\n  input3: {\n    rule: ValidationRuleType.only,\n    type: \"number\"\n  },\n  input4: {\n    rule: ValidationRuleType.only,\n    type: \"number\"\n  }\n};\n/* -- */\n\nexport const EmailContext = React.createContext({\n  email: null,\n  codeId: null\n});\n\nconst ResetPasswordForm = () => {\n  /* state of the form\r\n   * 0: init state > send reset password email form\r\n   * 1: form to validate the code received in the reset password email\r\n   * 2: form to reset the password\r\n   */\n  const {\n    0: formState,\n    1: setFormState\n  } = useState(0);\n  const {\n    0: context,\n    1: setContext\n  } = useState({\n    email: null,\n    codeId: null\n  });\n  const queryOptions0 = {\n    query: SEND_PASSWORD_RESET_EMAIL,\n    resultLabel: \"sendResetPasswordEmail\",\n    snackbarSucceedMessage: \"Un email vous a été envoyé.\",\n    afterResultControlCallback: useCallback((formvalues, data, error) => {\n      if (!error) {\n        setFormState(1);\n        setContext({\n          email: formvalues.email,\n          codeId: data.sendResetPasswordEmail\n        });\n      }\n    }, [setFormState]),\n    mutationResultControl: \"builtin\"\n  }; // const setEmailContext = useCallback((formValues, data, error) => {\n  //   const setEmail = useContext(SetEmailContext)\n  //   // @ts-ignore\n  //   setEmail(formValues.email)\n  // }, [])\n\n  return __jsx(EmailContext.Provider, {\n    value: context,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 5\n    }\n  }, formState == 0 && __jsx(ResetPasswordFormLayout, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 9\n    }\n  }, __jsx(FormController, {\n    render: ResetPasswordEmailForm,\n    validationRules: validationRules0,\n    withQuery: true,\n    queryOptions: queryOptions0,\n    key: \"formController-0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 11\n    }\n  })), formState == 1 && __jsx(ResetPasswordFormLayout, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 9\n    }\n  }, __jsx(FormController, {\n    render: ValidateEmailCodeForm,\n    validationRules: validationRules1 // withQuery={true}\n    // queryOptions={queryOptions1}\n    ,\n    key: \"formController-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 11\n    }\n  }))); // if (formState == 0)\n  //   return (\n  //     <ResetPasswordFormLayout>\n  //       <FormController\n  //         render={ResetPasswordEmailForm}\n  //         validationRules={validationRules0}\n  //         withQuery={true}\n  //         queryOptions={queryOptions0}\n  //         key=\"formController-0\"\n  //       />\n  //     </ResetPasswordFormLayout>\n  //   )\n  // if (formState == 1)\n  //   return (\n  //     <ResetPasswordFormLayout>\n  //       <FormController\n  //         render={ValidateEmailCodeForm}\n  //         validationRules={validationRules1}\n  //         // withQuery={true}\n  //         // queryOptions={queryOptions1}\n  //         key=\"formController-1\"\n  //       />\n  //     </ResetPasswordFormLayout>\n  //   )\n};\n\nexport default withApollo()(ResetPasswordForm);","map":{"version":3,"sources":["C:/Users/skaPy/IdeaProjects/Next.js-boilerplate/oozie-client/containers/forms/ResetPassword/ResetPasswordForm.tsx"],"names":["React","gql","FormController","ValidationRuleType","withApollo","useState","useCallback","ResetPasswordEmailForm","ValidateEmailCodeForm","Container","Box","Avatar","Typography","VpnKeyOutlinedIcon","makeStyles","useStyles","theme","avatar","margin","spacing","backgroundColor","palette","secondary","main","title","marginBottom","ResetPasswordFormLayout","children","styles","SEND_PASSWORD_RESET_EMAIL","validationRules0","email","rule","validationRules1","input1","only","type","input2","input3","input4","EmailContext","createContext","codeId","ResetPasswordForm","formState","setFormState","context","setContext","queryOptions0","query","resultLabel","snackbarSucceedMessage","afterResultControlCallback","formvalues","data","error","sendResetPasswordEmail","mutationResultControl"],"mappings":"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","sourcesContent":["import React, { useContext } from \"react\"\r\nimport gql from \"graphql-tag\"\r\nimport FormController, {\r\n  ValidationRules,\r\n  ValidationRuleType,\r\n  QueryOptions,\r\n} from \"components/controllers/FormController\"\r\nimport { withApollo } from \"hoc/withApollo\"\r\nimport { useState, useCallback } from \"react\"\r\nimport ResetPasswordEmailForm from \"containers/forms/ResetPassword/subForms/SendResetPsswdEmailForm\"\r\nimport ValidateEmailCodeForm from \"./subForms/ValidateEmailCodeForm\"\r\nimport { Container, Box, Avatar, Typography } from \"@material-ui/core\"\r\nimport VpnKeyOutlinedIcon from \"@material-ui/icons/VpnKeyOutlined\"\r\nimport { makeStyles } from \"@material-ui/core\"\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  avatar: {\r\n    margin: theme.spacing(1),\r\n    backgroundColor: theme.palette.secondary.main,\r\n  },\r\n  title: {\r\n    marginBottom: theme.spacing(3),\r\n  },\r\n}))\r\n\r\nconst ResetPasswordFormLayout = ({ children }: { children: JSX.Element }) => {\r\n  const styles = useStyles()\r\n\r\n  return (\r\n    <Container component=\"main\" maxWidth=\"xs\">\r\n      <Box\r\n        marginTop={8}\r\n        display=\"flex\"\r\n        flexDirection=\"column\"\r\n        alignItems=\"center\"\r\n      >\r\n        <Avatar className={styles.avatar}>\r\n          <VpnKeyOutlinedIcon />\r\n        </Avatar>\r\n        <Typography component=\"h1\" variant=\"h5\" className={styles.title}>\r\n          Mot de passe perdu\r\n        </Typography>\r\n        {children}\r\n      </Box>\r\n    </Container>\r\n  )\r\n}\r\n\r\n/* Reset password email form : step 0*/\r\nconst SEND_PASSWORD_RESET_EMAIL = gql`\r\n  mutation sendResetPasswordEmail($formValues: ResetPasswordInfos) {\r\n    sendResetPasswordEmail(resetPasswordInfos: $formValues)\r\n  }\r\n`\r\nconst validationRules0: ValidationRules = {\r\n  email: {\r\n    rule: ValidationRuleType.email,\r\n  },\r\n}\r\n\r\n/* -- */\r\n\r\n/* reset code validation form : step 1*/\r\n// const SEND_PASSWORD_RESET_EMAIL = gql`\r\n//   mutation sendResetPasswordEmail($formValues: ResetPasswordInfos) {\r\n//     sendResetPasswordEmail(resetPasswordInfos: $formValues)\r\n//   }\r\n// `\r\nconst validationRules1: ValidationRules = {\r\n  input1: {\r\n    rule: ValidationRuleType.only,\r\n    type: \"number\",\r\n  },\r\n  input2: {\r\n    rule: ValidationRuleType.only,\r\n    type: \"number\",\r\n  },\r\n  input3: {\r\n    rule: ValidationRuleType.only,\r\n    type: \"number\",\r\n  },\r\n  input4: {\r\n    rule: ValidationRuleType.only,\r\n    type: \"number\",\r\n  },\r\n}\r\n\r\n/* -- */\r\n\r\ntype EmailContext = {\r\n  email: string | null\r\n  codeId: number | null\r\n}\r\n\r\nexport const EmailContext = React.createContext({\r\n  email: null,\r\n  codeId: null,\r\n} as EmailContext)\r\n\r\nconst ResetPasswordForm = () => {\r\n  /* state of the form\r\n   * 0: init state > send reset password email form\r\n   * 1: form to validate the code received in the reset password email\r\n   * 2: form to reset the password\r\n   */\r\n  const [formState, setFormState] = useState<number>(0)\r\n\r\n  const [context, setContext] = useState<EmailContext>({\r\n    email: null,\r\n    codeId: null,\r\n  })\r\n\r\n  const queryOptions0: QueryOptions = {\r\n    query: SEND_PASSWORD_RESET_EMAIL,\r\n    resultLabel: \"sendResetPasswordEmail\",\r\n    snackbarSucceedMessage: \"Un email vous a été envoyé.\",\r\n    afterResultControlCallback: useCallback(\r\n      (formvalues, data, error) => {\r\n        if (!error) {\r\n          setFormState(1)\r\n          setContext({\r\n            email: formvalues.email,\r\n            codeId: data.sendResetPasswordEmail,\r\n          })\r\n        }\r\n      },\r\n      [setFormState]\r\n    ),\r\n    mutationResultControl: \"builtin\",\r\n  }\r\n\r\n  // const setEmailContext = useCallback((formValues, data, error) => {\r\n  //   const setEmail = useContext(SetEmailContext)\r\n  //   // @ts-ignore\r\n  //   setEmail(formValues.email)\r\n  // }, [])\r\n\r\n  return (\r\n    <EmailContext.Provider value={context}>\r\n      {/* <SetEmailContext.Provider value={setEmail}> */}\r\n      {formState == 0 && (\r\n        <ResetPasswordFormLayout>\r\n          <FormController\r\n            render={ResetPasswordEmailForm}\r\n            validationRules={validationRules0}\r\n            withQuery={true}\r\n            queryOptions={queryOptions0}\r\n            key=\"formController-0\"\r\n          />\r\n        </ResetPasswordFormLayout>\r\n      )}\r\n\r\n      {formState == 1 && (\r\n        <ResetPasswordFormLayout>\r\n          <FormController\r\n            render={ValidateEmailCodeForm}\r\n            validationRules={validationRules1}\r\n            // withQuery={true}\r\n            // queryOptions={queryOptions1}\r\n            key=\"formController-1\"\r\n          />\r\n        </ResetPasswordFormLayout>\r\n      )}\r\n      {/* </SetEmailContext.Provider> */}\r\n    </EmailContext.Provider>\r\n  )\r\n\r\n  // if (formState == 0)\r\n  //   return (\r\n  //     <ResetPasswordFormLayout>\r\n  //       <FormController\r\n  //         render={ResetPasswordEmailForm}\r\n  //         validationRules={validationRules0}\r\n  //         withQuery={true}\r\n  //         queryOptions={queryOptions0}\r\n  //         key=\"formController-0\"\r\n  //       />\r\n  //     </ResetPasswordFormLayout>\r\n  //   )\r\n\r\n  // if (formState == 1)\r\n  //   return (\r\n  //     <ResetPasswordFormLayout>\r\n  //       <FormController\r\n  //         render={ValidateEmailCodeForm}\r\n  //         validationRules={validationRules1}\r\n  //         // withQuery={true}\r\n  //         // queryOptions={queryOptions1}\r\n  //         key=\"formController-1\"\r\n  //       />\r\n  //     </ResetPasswordFormLayout>\r\n  //   )\r\n}\r\n\r\nexport default withApollo()(ResetPasswordForm)\r\n"]},"metadata":{},"sourceType":"module"}